I"ƒ<pre>
# coding:utf8

import torndb

# å»ºç«‹è¿æ¥
# ä¸œ8åŒºï¼Œé»˜è®¤å­—ç¬¦é›†UTF8ï¼Œæ²¡å¿…è¦åœ¨åŠ ä¸Š charset = "utf8" ã€‚
db = torndb.Connection('127.0.0.1:3306', 'database', 'user', 'password', time_zone='+8:00')

# æŸ¥è¯¢
## query: å¾—åˆ°å¤šè¡Œè®°å½•ï¼Œå•è¡Œä¸ºå­—å…¸
sql = '''SELECT * FROM sms_task WHERE id &gt; %s'''
rows = db.query(sql, 10)

## getï¼š å¾—åˆ°å•è¡Œè®°å½•ï¼Œä¸€ä¸ªå­—å…¸
sql = '''SELECT * FROM sms_task WHERE id = %s'''
info = db.get(sql, 10)


# æ›´æ–°
sql = '''UPDATE sms_task SET `status` = %s WHERE id = %s'''
affected_row_count = db.update(sql, 0, 10)


# æ’å…¥
sql = '''INSERT INTO sms_task_phone (phone, uid) VALUES (%s, %s)'''
args = [0, 0]
last_id = db.insert(sql, *args)


# åˆ é™¤
sql = '''DELETE FROM sms_task WHERE id = %s'''
affected_row_count = db.execute_rowcount(sql, 8)


# äº‹åŠ¡
## begin çš„æ–¹å¼ä½¿ç”¨äº‹åŠ¡
def transacion_begin():
    try:
        db._db.begin()

        sql = ''' SELECT `status`, is_deleted FROM sms_task WHERE id = %s FOR UPDATE '''
        info = db.get(sql, 10)
        if not info:
            return False

        sql = ''' UPDATE sms_task SET is_deleted = %s WHERE id = %s '''
        db.update(sql, 1, 10)

        db._db.commit()
    except Exception, e:
        db._db.rollback()
        print str(e)
        return False

    return True

transacion_begin()

## autocommit çš„æ–¹å¼ä½¿ç”¨äº‹åŠ¡
def transacion_autocommit():
    try:
        db._db.autocommit(False)

        sql = ''' SELECT `status`, is_deleted FROM sms_task WHERE id = %s FOR UPDATE '''
        info = db.get(sql, 10)
        if not info:
            return False

        sql = ''' UPDATE sms_task SET is_deleted = 1 WHERE id = %s '''
        db.update(sql, 10)

        db._db.commit()
    except Exception, e:
        db._db.rollback()
        print str(e)
        return False
    finally:
        db._db.autocommit(True)

    return True

transacion_autocommit()
</pre>
:ET